% vim:autoindent:set textwidth=78:

\section{Print Composer}\label{label_printcomposer}

% when the revision of a section has been finalized, 
% comment out the following line:
% \updatedisclaimer

Der Print Composer bietet eine wachsende Anzahl von Layout- und
Druckfunktionen. Es ist möglich, Elemente wie ein Kartenfenster, eine
Legende, einen Maßstab, Bilder und Texte zu layouten und dann zu drucken. Sie
können Größe, Ausrichtung, Position sowie die Eigenschaften jedes Elements
anpassen und diese in Gruppen zusammenfassen. Das Layout kann gedruckt (auch als
Postscript und PDF), als Bild oder SVG exportiert werden, \footnote{Der
Export nach SVG wird unterstützt, aber es funktioniert nicht korrekt mit
allen QT4 Versionen. Sie sollten das jeweils auf Ihrem Rechner testen.} und
als Vorlage gespeichert und in einer anderen QGIS Sitzung wieder verwendet
werden. Eine Liste der Print Composer Funktionen sehen Sie in
Tabelle~\ref{tab:printcomposer_tools}

\begin{table}[h]\index{Print Composer!Funktionen}
\centering
\caption{Print Composer Funktionen}\label{tab:printcomposer_tools}\medskip
 \begin{tabular}{|l|p{6.9cm}|l|p{6.9cm}|}
 \hline \textbf{Icon} & \textbf{Zweck} & \textbf{Icon} &
 \textbf{Zweck} \\
 \hline \includegraphics[width=0.7cm]{mActionFolder} & Aus Vorlage laden &
 \includegraphics[width=0.7cm]{mActionFileSaveAs} & Als Vorlage speichern \\
 \hline \includegraphics[width=0.7cm]{mActionExportMapServer}
 & Speichern als Rasterbild & 
 \includegraphics[width=0.7cm]{mActionSaveAsSVG} & Speichern als SVG \\
 \hline \includegraphics[width=0.7cm]{mActionFilePrint} & Drucken, auch als PDF und Postscript &
 \includegraphics[width=0.7cm]{mActionZoomFullExtent} & Volle Ausdehnung \\
 \hline \includegraphics[width=0.7cm]{mActionZoomIn} & Hineinzoomen &
 \includegraphics[width=0.7cm]{mActionZoomOut} & Hinauszoomen \\
 \hline \includegraphics[width=0.7cm]{mActionDraw} & Aktualisiere Ansicht &
 \includegraphics[width=0.7cm]{mActionAddRasterLayer} & Neue Karte hinzufügen \\
 \hline \includegraphics[width=0.7cm]{mActionSaveMapAsImage} & Bild
hinzufügen &
 \includegraphics[width=0.7cm]{mActionLabel} & Neue Beschriftung hinzufügen \\
 \hline \includegraphics[width=0.7cm]{mActionAddLegend} & Neue Vektorlegende
hinzufügen & 
 \includegraphics[width=0.7cm]{mActionScaleBar} & Neuen Maßstab hinzufügen\\
 \hline \includegraphics[width=0.7cm]{mActionSelectPan} & Eintrag
wählen/verschieben &
 \includegraphics[width=0.7cm]{mActionMoveItemContent} & Den Elementinhalt
verschieben \\
 \hline \includegraphics[width=0.7cm]{mActionGroupItems} & Elemente
gruppieren & 
 \includegraphics[width=0.7cm]{mActionUngroupItems} & Die Gruppe auflösen \\
 \hline \includegraphics[width=0.7cm]{mActionRaiseItems} & Ausgewählte
Elemente in den Vordergrund bringen &
 \includegraphics[width=0.7cm]{mActionLowerItems} & Ausgewählte
Elemente in den Hintergrund bringen \\
 \hline \includegraphics[width=0.7cm]{mActionMoveItemsToTop} & Ausgewählte
Elemente in den Vordergrund schieben & 
 \includegraphics[width=0.7cm]{mActionMoveItemsToBottom} & Ausgewählte
Elemente in den Hintergrund stellen \\
 \hline \includegraphics[width=0.7cm]{mActionAlignLeft} & Ausgewählte
Elemente links ausrichten &
 \includegraphics[width=0.7cm]{mActionAlignRight} & Ausgewählte
Elemente rechts ausrichten \\
 \hline \includegraphics[width=0.7cm]{mActionAlignHCenter} & Ausgewählte
Elemente zentriert ausrichten &
 \includegraphics[width=0.7cm]{mActionAlignVCenter} & Ausgewählte
Elemente vertika zentriert ausrichten \\
 \hline \includegraphics[width=0.7cm]{mActionAlignTop} & Ausgewählte
Elemente oben ausrichten &
 \includegraphics[width=0.7cm]{mActionAlignBottom} & Ausgewählte
Elemente unten ausrichten \\
\hline
\end{tabular}
\end{table}

Um den Print Composer zu starten, klicken Sie auf den Knopf
\toolbtntwo{mActionFilePrint}{Druckzusammenstellung} in der Werkzeugleiste
oder wählen Sie im Menü \mainmenuopt{File} >
\dropmenuopttwo{mActionFilePrint}{Druckzusammenstellung}.

\subsection{Den Print Composer verwenden}\label{label_useprintcomposer} 

Um den Print Composer zu verwenden, laden Sie zuerst einige Raster- und
Vektorlayer, die Sie layouten möchten in das Kartenfenster und geben Sie
ihnen das für den Druck gewünschte Aussehen. Nachdem alles nach ihren
Wünschen eingestellt ist, klicken Sie auf den Knopf
\toolbtntwo{mActionFilePrint}{Drucken}.

\begin{figure}[ht]
\begin{center}
   \caption{Print Composer \nixcaption}\label{fig:print_composer_blank}\smallskip
   \includegraphics[clip=true, width=\textwidth]{print_composer_blank}
\end{center}  
\end{figure}

Wenn Sie den Print Composer öffnen, sehen Sie erstmal nur ein weißes Blatt
vor sich, auf dem Sie dann die Elemente Kartenfenster, Legende, Maßstab, Bilder
und Texte hinzufügen können. Abbildung \ref{fig:print_composer_blank} zeigt den
Anfangsbildschirm des Print Composers mit aktiviertem \checkbox{Am Raster
ausrichten} Kontrollkästchen, bevor Elemente hinzugefügt werden.
Dabei werden auf der rechten Seite zwei Reiter bereitgestellt.

\begin{itemize}
\item Der Reiter \tab{Allgemein} ermöglicht es, die Papiergröße,
-ausrichtung, Auflösung der Druckkarte in DPI zu definieren und das
Kontrollkästchen \checkbox{Am Raster ausrichten} zu aktivieren und eine
Rasterauflösung festzulegen. Beachten Sie, das Ausrichten am Raster
funktioniert nur, wenn sie eine Rasterauflösung > 0 definieren. Darüberhinaus
können Sie das Kontrollkästchen \checkbox{Als Raster drucken} aktivieren.
Dabei werden alle Elemente zuerst rasterisiert, bevor sie gedruckt oder im
Postscript of PDF Format gespeichert werden.
\item Der Reiter \tab{Eintrag} gibt die Eigenschaften für das aktuell
gewählte Kartenobjekt wieder. Wenn Sie mit dem Knopf
\toolbtntwo{mActionSelectPan}{Eintrag wählen/verschieben} ein Element im
Fenster selektieren (z.B. Legende, Maßstab, Bild. usw) und dann auf den
Reiter \tab{Eintrag} klicken, können Sie dessen Eigenschaften anpassen.
\end{itemize}

Es können mehrere Elemente im Print Composer angelegt werden, also auch mehr
als ein Kartenfenster mit eigener Legende. Jedes Element hat seine eigenen
Eigenschaften und im Fall des Kartenfensters eine eigene Ausdehnung.

\subsubsection{Eine Karte zum Print Composer hinzufügen}

Um Layer im Kartenfenster des Print Composers darzustellen, klicken Sie auf
den Knopf \toolbtntwo{mActionAddRasterLayer}{Neue Karte hinzufügen} in der
Werkzeugleiste. Ziehen Sie dann mit der Maus ein Rechteck im Kartenfenster
auf, um die aktuell visualisierten Layer darzustellen. Sie dann die Meldung
\usertext{Karte wird hier gedruckt}. Um den aktuellen Ausschnitt des QGIS
Kartenfensters zu sehen, können Sie zwischen drei verschiedenen Modi im
Reiter \tab{Eintrag} im Bereich Vorschau wählen:  

\begin{itemize}
\item \selectstring{Vorschau}{Rechteck} ist die Standardeinstellung. Es wird
eine leeres Kästchen mit der Meldung \textit{'Karte wird hier gedruckt'}
angezeigt.
\item \selectstring{Vorschau}{Cache} führt dazu, dass die Karte in der momentanen
Bildschirmauflösung gerendert wird. Wenn man im Composer zoomt, wird nicht neu
gerendert sondern nur das Bild skaliert.
\item \selectstring{Vorschau}{Zeichnen} führt dazu, dass beim Zoomen im
Composer neu gerendert wird, aber aus Speicherplatzgründen nur bis zu einer
Maximalauflösung.
\end{itemize}

\begin{figure}[ht]
\centering
\caption{Reiter im Print Composer \nixcaption}\label{fig:print_composer_map_item}
   \subfigure[Reiter für Allgemeine Einstellungen]
{\label{subfig:print_composer_map_item1}\includegraphics[clip=true, width=0.4\textwidth]{print_composer_map_item1}}\goodgap
   \subfigure[Reiter für objektbezogene Einstellungen]
{\label{subfig:print_composer_map_item2}\includegraphics[clip=true, width=0.4\textwidth]{print_composer_map_item2}}
\end{figure}

Sie können die Größe des Kartenfensters im Print Composer nachträglich
verändern, indem sie auf den Knopf
\toolbtntwo{mActionSelectPan}{Selektiere/Verschiebe Eintrag} klicken, mit der
Maus das Kartenfenster auswählen und die Größe an den blauen Ecken verändern.
Sie können die Größe auch verändern, indem Sie das Element selektieren und
die Breite und Höhe im Reiter \tab{Eintrag} anpassen. An dieser Stelle können
Sie auch weitere Einstellungen vornehmen. Z.B. den Kartenausschnitt anhand
von Eck-Koordinaten festlegen oder auf den Knopf \button{Anzeigegrenzen
übernehmen} drücken, um auf die Ausdehnung des QGIS Kartenfenster zu zoomen.

Ausserdem können Sie die Elementeigenschaften des Kartenbereichs anpassen,
indem Sie einen Farbe und Stärke für den Rahmen angeben, eine
Hintergrundfarbe festlegen, Transparenz definieren und in dem
Kontrollkästchen \checkbox{Rahmen} auswählen, ob dieser angezeigt werden soll
oder nicht. Das Kartenfenster des Print Composers ist mit dem Kartenfenster
von QGIS verbunden. Wenn Sie im Kartenfenster von QGIS etwas verändern (zoomen,
Layer hinzufügen usw.) können Sie das Kartenelement im Print Composer
anpassen, indem Sie es selektieren und im Reiter \tab{Eintrag} auf den Knopf
\texttt{Vorschau aktualisieren} klicken (siehe Abbildung~\ref{fig:print_composer_map_item}).

Um Layer innerhalb des Print Composer im Kartenelement zu verschieben,
klicken Sie auf den Knopf \toolbtntwo{mActionMoveItemContent}{Den
Elementinhalt verschieben}. Sie können nun mit der linken Maustaste die Layer
im Kartenelement verschieben.

\subsubsection{Im Print Composer navigieren}

Zur Navigation im Print Composer stehen vier Werkeuge zur Verfügung:

\begin{itemize}
\item \toolbtntwo{mActionZoomOut}{Hineinzoomen},
\item \toolbtntwo{mActionZoomOut}{Hinauszoomen},
\item \toolbtntwo{mActionZoomFullExtent}{Volle Ausdehung} und
\item \toolbtntwo{mActionDraw}{Aktualisiere Ansicht}.
\end{itemize}

\subsubsection{Weitere Elemente zum Print Composer hinzufügen}

Neben einem Kartenfenster können auch die Elemente Legende, Maßstab, Bild und
Beschriftung im Print Composer angelegt, ausgerichtet, verschoben und
angepasst werden. Jedes Element hat dabei seine eigenen Eigenschaften und
seine eigene Ausdehnung.

\minisec{Beschriftung und Bild}

Um eine Beschriftung oder ein Bild hinzuzufügen, klicken Sie auf den Knopf
\toolbtntwo{mActionLabel}{Neue Beschriftung hinzufügen} oder
\toolbtntwo{mActionSaveMapAsImage}{Bild hinzufügen} und plazieren Sie das
Element und seine Ausrichtung nach ihren Wünschen und passen Sie das
Erscheinungsbild im Reiter \tab{Eintrag} an. 

\begin{figure}[ht]
\centering
\caption{Anpassen der Print Composer Elemente Beschriftung und Bild \nixcaption}\label{fig:print_composer_tab2}
   \subfigure[Reiter Eintrag für Beschriftung]
{\label{subfig:print_composer_label_item}\includegraphics[clip=true, width=0.4\textwidth]{print_composer_label_item}}\goodgap
   \subfigure[Reiter Eintrag für Bild]
{\label{subfig:print_composer_image_item}\includegraphics[clip=true, width=0.4\textwidth]{print_composer_image_item}}
\end{figure}

\minisec{Vektorlegende und Maßstab}

Um eine Vektorlegende oder einen Maßstab hinzuzufügen, klicken Sie auf den Knopf 
\toolbtntwo{mActionAddLegend}{Neue Vektorlegende hinzufügen} oder
\toolbtntwo{mActionScaleBar}{Neuen Maßstab hinzufügen} und und plazieren Sie
das Element und dessen Ausrichtung nach ihren Wünschen und passen Sie das
Erscheinungsbild im Reiter \tab{Eintrag} an.

\begin{figure}[ht]
\centering
\caption{Anpassen der Print Composer Elemente Vektorlegende und Maßstab \nixcaption}\label{fig:print_composer_tab1}
   \subfigure[Reiter Eintrag Vektorlegende]
{\label{subfig:print_composer_legend_item}\includegraphics[clip=true, width=0.4\textwidth]{print_composer_legend_item}}\goodgap
   \subfigure[Reiter Eintrag Maßstab]
{\label{subfig:print_composer_scalebar_item}\includegraphics[clip=true, width=0.4\textwidth]{print_composer_scalebar_item}}
\end{figure}

\subsubsection{Elemente in den Vorder- oder Hintergrund bringen und
ausrichten}

Die Funktionalitäten, um Elemente in den Vorder- oder Hintergrund bringen zu
bringen, befinden sich im \toolbtntwo{mActionRaiseItems}{Ausgwählte Elemente
in den Vordergrund bringen} Pulldown Menü. Aktivieren Sie mit der linken
Maustaste ein Element im Kartenfenster des Print Composers und wählen Sie die
passende Funktionalität aus, um das Elemente relativ zu den anderen in den
Vorder- oder Hintergrund zu bringen (siehe
Tabelle~\ref{tab:printcomposer_tools}).     

Die Funktionalitäten, um Elemente im Kartenfenster des Print Composers
auszurichten finden Sie im \toolbtntwo{mActionAlignLeft}{Alle ausgewählten
Elemente ausrichten} Pulldown Menü. Aktivieren Sie mit der linken
Maustaste ein Element im Kartenfenster des Print Composers und wählen Sie die
passende Funktionalität aus (siehe Tabelle~\ref{tab:printcomposer_tools}).
Alle selektierten Elemente werden dann an ihrer gemeinsamen Bounding Box
entsprechend ausgerichtet.

\subsubsection{Eine Ausgabe erzeugen}

Abbildung~\ref{fig:print_composer_complete} zeigt den Print Composer mit
einem Beispiel Printlayout, das alle in diesem Kapitel angesprochenen
Elemente zeigt.

\begin{figure}[h]
   \begin{center}
   \caption{Print Composer Layout mit Karte, Legende, Maßstab und Beschriftung \nixcaption}
   \label{fig:print_composer_complete}\smallskip
   \includegraphics[clip=true, width=\textwidth]{print_composer_complete}
\end{center}  
\end{figure}

Mit dem Print Composer kann eine Karte in definierter Auflösung und Größe
gedruckt, sowie als Rasterbild oder ins SVG-Format exportiert werden.

\begin{itemize}
\item Der Knopf \toolbtntwo{mActionFilePrint}{Drucken} ermöglicht das Drucken
auf einem angeschlossenen Drucker, oder als PDF oder Postscript in
Abhängigkeit von den installierten Druckertreibern
\item Der Knopf \toolbtntwo{mActionExportMapServer}{Speichere als Rasterbild}
exportiert das Drucklayout in verschiedene Bildformate, z.B.: PNG, BPM, TIF,
JPG, \dots
\item Der Knopf \toolbtntwo{mActionSaveAsSVG}{Speichern als SVG} speichert
das aktuelle Drucklayout als SVG (Scalable Vector
Graphic).\textbf{Bemerkung:} Aktuell ist die SVG-Ausgabe noch unvollständig,
da die verwendete QT4 Bibliothek noch nicht einwandfrei arbeitet. Dieses
Problem wird hoffentlich mit der Zeit verschwinden.
\end{itemize}

\subsubsection{Ein Print Composer Layout als Vorlage speichern und laden}

Mit den Icons \toolbtntwo{mActionFileSaveAs}{Als Vorlage speichern} und
\toolbtntwo{mActionFolder}{Aus Vorlage laden} können Sie den aktuellen Stand
einer Print Composer Sitzung als ein Template mit der Dateiendung *.qpt
speichern und entsprechend in einer anderen Sitzung wieder laden.


